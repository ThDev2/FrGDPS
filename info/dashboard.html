<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>FrGDPS Dashboard</title>
  <style>
    /* RESET & BASE */
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:sans-serif;background:#121212;color:#eee;padding:1rem;min-height:100vh;}
    h1{text-align:center;margin-bottom:1rem;}
    /* TABS */
    .tabs{display:flex;gap:.5rem;overflow-x:auto;margin-bottom:1rem;}
    .tab{padding:.5rem 1rem;background:#1e1e1e;color:#ccc;border-radius:4px;cursor:pointer;flex-shrink:0;display:flex;align-items:center;gap:.3rem;}
    .tab.active{background:#4fc3f7;color:#121212;}
    /* PANELS */
    .content{display:none;}
    .content.active{display:block;}
    /* BOX */
    .box{background:#1a1a1a;padding:1rem;border-radius:6px;margin-bottom:1rem;}
    input,textarea,button{width:100%;padding:.6rem;margin:.5rem 0;border:none;border-radius:4px;font-size:1rem;}
    button{background:#4fc3f7;color:#121212;cursor:pointer;}
    button:hover{filter:brightness(1.1);}
    /* FEATURED CARD */
    .featured-card{background:#222;padding:1rem;border-radius:6px;box-shadow:0 0 8px rgba(255,0,85,0.5);}
    .featured-card h3{margin-bottom:.5rem;color:#ff0055;}
    .featured-card p{margin:.3rem 0;font-size:.95rem;}
    .featured-card .meta{display:flex;gap:1rem;flex-wrap:wrap;font-size:.9rem;}
    .featured-card .meta span{background:#333;padding:.3rem .6rem;border-radius:4px;}
    /* STATS GRID */
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1rem;margin-top:1rem;}
    .stat-card{background:#222;padding:.8rem;border-radius:6px;text-align:center;box-shadow:0 0 6px rgba(79,195,247,0.5);}
    .stat-card h3{font-size:1rem;margin-bottom:.4rem;color:#4fc3f7;}
    .stat-card p{font-size:.9rem;color:#ddd;}
    /* LOGIN & SEARCH CARD */
    .login-card, .search-card {
      background:#222;padding:1rem;border-radius:6px;box-shadow:0 0 6px rgba(0,150,136,0.5);margin-top:1rem;
    }
    .login-card.error, .search-card.error {
      border:1px solid #e74c3c;background:#300;
    }
    .login-card h3, .search-card h3 {margin-top:0;color:#4fc3f7;}
    .meta{display:flex;flex-wrap:wrap;gap:.5rem 1rem;margin:.5rem 0;}
    .color-swatch{display:inline-block;width:1rem;height:1rem;border:1px solid #999;vertical-align:middle;margin-right:.25rem;}
    .user-icon{width:32px;height:32px;vertical-align:middle;border-radius:4px;}
    .song-card{border-top:1px solid #444;padding-top:.5rem;margin-top:.5rem;}
    .song-card h4{margin:.25rem 0;}
    .song-card a{text-decoration:none;font-weight:bold;color:#4fc3f7;}
  </style>
</head>
<body>
  <h1>FrGDPS Dashboard</h1>
  <div class="tabs">
    <div class="tab active" data-tab="login">🔐 Login</div>
    <div class="tab" data-tab="search">🔍 Cari Level</div>
    <div class="tab" data-tab="featured">🔥 Level Pilihan</div>
    <div class="tab" data-tab="stats">📊 Stats</div>
    <div class="tab" data-tab="profile">👤 Profile</div>
    <div class="tab" data-tab="whoRated">⭐ Who Rated</div>
  </div>

  <!-- LOGIN -->
  <div id="login" class="content active">
    <div class="box">
      <h2>Login GDPS</h2>
      <input id="login-user" placeholder="Username">
      <input id="login-pass" placeholder="Password" type="password">
      <button onclick="doLogin()">🔑 Masuk</button>
      <div id="login-res"></div>
    </div>
  </div>

  <!-- SEARCH LEVEL -->
  <div id="search" class="content">
    <div class="box">
      <h2>Cari Level</h2>
      <input id="search-id" placeholder="Level ID">
      <button onclick="doSearch()">🔎 Cari</button>
      <div id="search-res"></div>
    </div>
  </div>

  <!-- FEATURED -->
  <div id="featured" class="content">
    <div class="box">
      <h2>🔥 Featured Level</h2>
      <div id="feat-res">Memuat…</div>
    </div>
  </div>

  <!-- STATS -->
  <div id="stats" class="content">
    <div class="box">
      <h2>📊 Server Stats</h2>
      <div id="stats-res">Memuat…</div>
    </div>
  </div>

  <!-- PROFILE -->
  <div id="profile" class="content">
    <div class="box">
      <h2>👤 Profile User</h2>
      <input id="profile-acc" placeholder="👥 Account ID">
      <button onclick="doProfile()">🔎 Muat Profil</button>
      <div id="profile-res"></div>
    </div>
  </div>

  <!-- WHO RATED -->
  <div id="whoRated" class="content">
    <div class="box">
      <h2>⭐ Who Rated Level</h2>
      <input id="wr-level" placeholder="Level ID">
      <button onclick="doWhoRated()">🔍 Cari</button>
      <pre id="whoRated-res"></pre>
    </div>
  </div>

  <script>
  const api = 'https://fless.ps.fhgdps.com/dashboard/api/';

  // Tab switching
  document.querySelectorAll('.tab').forEach(t=>{
    t.onclick = ()=>{
      document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
      document.querySelectorAll('.content').forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      document.getElementById(t.dataset.tab).classList.add('active');
    };
  });

  // Helper to get encoded value by id
  const v = id => encodeURIComponent(document.getElementById(id).value);

  // LOGIN
  function doLogin(){
    fetch(api+'login.php', {
      method:'POST',
      headers:{'Content-Type':'application/x-www-form-urlencoded'},
      body:`userName=${v('login-user')}&password=${v('login-pass')}`
    })
    .then(r=>r.json())
    .then(j=>renderLogin(j))
    .catch(e=>document.getElementById('login-res').innerHTML = `<div class="login-card error"><p>❌ Error: ${e}</p></div>`);
  }

  function renderLogin(resp) {
    if (!resp.success) {
      document.getElementById('login-res').innerHTML = `
        <div class="login-card error">
          <p>❌ Login gagal: ${resp.error || 'Unknown error'}</p>
        </div>`;
      return;
    }
    document.getElementById('login-res').innerHTML = `
      <div class="login-card">
        <h3>✅ Welcome, ${resp.user}!</h3>
        <div class="meta">
          <span><strong>Account ID:</strong> ${resp.accountID}</span>
          <span><strong>Auth Token:</strong> <code>${resp.auth}</code></span>
        </div>
        <div class="meta">
          <span><strong>Color:</strong> <span class="color-swatch" style="background-color: rgb(${resp.color});"></span> rgb(${resp.color})</span>
          <span><strong>Icon:</strong> <img src="${resp.mainIcon}" alt="User Icon" class="user-icon"></span>
        </div>
        <div class="meta">
          <strong>Clan:</strong>
          ${resp.clan.length
            ? '<ul>' + resp.clan.map(c => `<li>${c}</li>`).join('')